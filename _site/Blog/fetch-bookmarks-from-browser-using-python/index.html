<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
    <head >
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Fetch bookmarks from Browser using Python &mdash; Aniket Pant</title>
        <meta name="author" content="">
        <meta name="description" content="">
        <meta name="keywords" content="jay, rambhia, computer vision, python, trakcing, keypoints, c, c++, simplecv, opencv">
        <meta name="viewport" content="width=device-width">

        
        

        <!-- stylesheets -->
        <link rel="stylesheet" href="/assets/styles/css/style.min.css">
    </head>
    <body>
        <!--[if lt IE 7]>
            <p class="chromeframe">You are using an outdated browser. <a href="http://browsehappy.com/">Upgrade your browser today</a> or <a href="http://www.google.com/chromeframe/?redirect=true">install Google Chrome Frame</a> to better experience this site.</p>
        <![endif]-->

        <div class="header-container gw">
            <div class="g one-whole zen-space full-width"></div>
            <div class="wrapper">
                <header class="g one-whole flexbox" role="banner">
                    <h1 class="g one-third portable-one-whole flexbox__item"><a class="logo media" href="/" rel="nofollow"><img class="media__item" src="/assets/images/logo.jpg" alt="Rawrrr! Aniket here." /></a></h1>
                    <nav class="g two-thirds portable-one-whole flexbox__item navbar">
                        <ul class="nav nav--block portable-nav--stacked">
                            <li><a href="/">Home</a></li>
                            <li><a href="/about-me">About Me</a></li>
                            <li><a href="/Blog">Blog</a></li>
                            <li><a href="/archive">Archive</a></li>
                        </ul>
                    </nav>
                    <div class="g two-thirds portable-one-whole flexbox__item">
                        <p class="islet about-me">I'm <strong>Aniket</strong>. I love to code, listen to music and I even write free-verses at times. A majority of my work is <em>writing syntax for design</em>.</p>
                    </div>
                    <p rel="google-authorship" class="accessibility">By Aniket Pant</p>
                </header> <!-- header -->
            </div>
        </div> <!-- header-container -->

        <div class="main-container gw">
            <div class="wrapper">
                <section class="g one-whole" role="main">
                <div class="post fetch-bookmarks-from-browser-using-python">
	<header class="g one-quarter portable-one-whole post--header">
  		<h1 class="post_title">Fetch bookmarks from Browser using Python</h1>
  		<div class="meta"><date class="date">Posted on 28 January 2012</date><br/>Under <span class="category">Blog</a><br/>Tagged </span><span class="tags">Python</span></div>
      <div class="share island">
        <a href="https://twitter.com/share" class="twitter-share-button" data-via="jayrambhia" data-related="jayrambhia">Tweet</a>
        <div class="g-plusone" data-size="medium"></div>
        <div class="fb-like" data-send="false" data-layout="button_count" data-width="450" data-show-faces="true"></div>
      </div>
      <div id="boastful"></div>
	</header><!-- post-header -->
	<div class="g three-quarters portable-one-whole">
		<article class="post--content">
	  	<p><strong>Tags</strong>: <strong>Python</strong>, <strong>json</strong>, <strong>bookmark</strong>, <strong>browser</strong>, <strong>firefox</strong>, <strong>tags</strong></p>

<h1 id="bookmarkjsonpy-gisthttpsgistgithubcom1693109"><a href="https://gist.github.com/1693109">bookmark_json.py gist</a></h1>

<p>So, after making a python script for fetching bookmarks from the exported HTML files, I was wondering how to make it work automatically so that I don’t need to give the HTML file every time. I started looking in firefox directory for some bookmark files which I could use. I found out that firefox keeps bookmark backups and they are encoded in json. I learned few things about json and started to write the script.
<strong>Importing Modules</strong></p>

<pre><code>import json
import os
</code></pre>

<p>Locate the directory in which the browser stores the bookmarks backup.<!-- more --></p>

<pre><code>directory = '/home/jay/.mozilla/firefox/qyrgphtu.default/bookmarkbackups' # bookmark backup directory
if not os.path.isdir(directory):
  return
for path, dirs, files in os.walk(directory):
# If there are any other directory in the backup directory, we need to stop the process and get the backup files only
  if path == directory:
    break
files = sorted(files) # sort all the backup files
filename = files[-1] # Get the latest backup file
file_path = os.path.join(directory, filename)
f=open(file_path,'r')
con = json.load(f) # Decode the file with json
f.close()
</code></pre>

<p>It was all easy till here. No trouble getting the file. The next part was really time consuming.
It was difficult to find out how the bookmarks were stored in the file.
The main content had 4 children.
1. Bookmarks Menu
2. Bookmarks Toolbar
3. Tags
4. Unsorted Bookmarks</p>

<p>Bookmarks Menu has tags ‘Mozilla Firefox’, ‘Ubuntu and Free Software links’, and all the Unsorted bookmarks.
Bookmarks Toolbar has nothing substantial. It has ‘Most Visited’, ‘Latest Headlines’ which are not stored in the backup files.
Tags has all the subtags as it’s children.
Unsorted Bookmarks has all the unsorted bookmarks as it’s children.</p>

<pre><code># Get Bookmarks Menu / Bookmarks toolbar / Tags / Unsorted Bookmarks
con_list = con['children'] # this list will have all of the above mentioned things

for i in range(len(con_list)):
  con_sub_list = con_list[i]['children']  # Access them individually
  for tags in con_sub_list:
    if tags.has_key('children'): # Accessing Tags # get tag list
      bookmarks = tags['children'] # get all the bookmarks corresponding to the tag
      if bookmarks:
        for bookmark in bookmarks: # Access each bookmark
          Tag = tags['title']
          uri = bookmark['uri']
          title = bookmark['title']
          dateAdded =  bookmark['dateAdded']
          # it gives a long int eg. 1326378576503359L
          add_date = dateAdded/1000000
          # The output of time.time() would be 1326378576.503359
          lastModified = bookmark['lastModified']
          # print date and time using time.ctime()
          modified_date = lastModified/1000000
    else:
        # Accessing Unsorted Bookmarks, etc
        # No need to access 'Recently Bookmarked', 'Recent Tags', 'Most Visited', 'Bookmarks Menu'

        if (tags['title'] != 'Recently Bookmarked'
            and tags['title'] != 'Recent Tags'
            and tags['title'] != 'Most Visited'
            and con_list[i]['title'] != 'Bookmarks Menu'):

          # Accessing Unsorted Bookmarks
          Tag = con_list[i]['title']
          title = tags['title']
          uri = tags['uri']
          dateAdded =  tags['dateAdded']
          add_date = dateAdded/1000000
          lastModified = tags['lastModified']
          modified_date = lastModified/1000000
</code></pre>

<p>Now, all the required information about bookmarks have been fetched. Now you can store it in database if you need. So using this script I can save all my bookmarks anytime!
Download the gist for complete code : <strong><a href="https://gist.github.com/1693109">bookmarks_json</a></strong>
P.S. Yes! things are getting prettier and easier with Python!</p>
  
		</article><!-- post-content -->
		<footer class="post--footer"></footer><!-- post-footer -->
    <section class="meta--info island">
      <p class="lead">
        <br/><br/>If you liked this post, then you should definitely follow Jay on twitter too. He would be excited to know that you like his work.
      </p>
      <a href="https://twitter.com/jayrambhia" class="twitter-follow-button" data-show-count="false">Follow @jayrambhia</a>
    </section>
  </div>
</div><!-- post -->

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.5.1/jquery.min.js"></script>
<script src="/assets/js/jquery.boastful.js"></script>
<script src="/assets/js/rainbow-custom.min.js"></script>

<script type="text/javascript">
  $(document).ready(function() {
    $('#boastful').boastful({
        empty_message: '<p>Bah! Why ain\'t anyone tweeting this.</p>'  
    });
  });
</script>
                </section>
            </div>
        </div> <!-- main-container -->

        <div class="footer-container gw">
            <div class="wrapper">
                <footer class="g one-whole text--center" role="contentinfo">
                    <a href="https://plus.google.com/114828599949215633124?rel=author" class="accessibility">Google +</a>
                    <p><a href="http://twitter.com/aniket_pant">@jayrambhia</a><span class="subtle">&nbsp;|&nbsp;Paranoid Android&nbsp;&nbsp;</span> 
                </footer> <!-- footer -->
            </div>
            <div class="g one-whole zen-space full-width"></div>
        </div> <!-- footer-container -->

        <script type="text/javascript">

          var _gaq = _gaq || [];
          _gaq.push(['_setAccount', 'UA-23477947-1']);
          _gaq.push(['_trackPageview']);

          (function() {
            var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
          })();

        </script>

        <!-- Typekit Fonts -->
        <script type="text/javascript">
          (function() {
            var config = {
              kitId: 'rsd5dqz',
              scriptTimeout: 3000
            };
            var h=document.getElementsByTagName("html")[0];h.className+=" wf-loading";var t=setTimeout(function(){h.className=h.className.replace(/(\s|^)wf-loading(\s|$)/g," ");h.className+=" wf-inactive"},config.scriptTimeout);var tk=document.createElement("script"),d=false;tk.src='//use.typekit.net/'+config.kitId+'.js';tk.type="text/javascript";tk.async="true";tk.onload=tk.onreadystatechange=function(){var a=this.readyState;if(d||a&&a!="complete"&&a!="loaded")return;d=true;clearTimeout(t);try{Typekit.load(config)}catch(b){}};var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(tk,s)
          })();

          (function(doc, script) {
            var js, 
                fjs = doc.getElementsByTagName(script)[0],
                frag = doc.createDocumentFragment(),
                add = function(url, id) {
                    if (doc.getElementById(id)) {return;}
                    js = doc.createElement(script);
                    js.src = url;
                    id && (js.id = id);
                    frag.appendChild( js );
                };
                
              // Google+ button
              add('http://apis.google.com/js/plusone.js');
              // Facebook SDK
              add('//connect.facebook.net/en_US/all.js#xfbml=1&appId=465363156848461', 'facebook-jssdk');
              // Twitter SDK
              add('//platform.twitter.com/widgets.js');

              fjs.parentNode.insertBefore(frag, fjs);
          }(document, 'script'));
        </script>

    </body>
</html>
