<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
    <head >
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Send emails using Python &mdash; Aniket Pant</title>
        <meta name="author" content="">
        <meta name="description" content="">
        <meta name="keywords" content="jay, rambhia, computer vision, python, trakcing, keypoints, c, c++, simplecv, opencv">
        <meta name="viewport" content="width=device-width">

        
        

        <!-- stylesheets -->
        <link rel="stylesheet" href="/assets/styles/css/style.min.css">
    </head>
    <body>
        <!--[if lt IE 7]>
            <p class="chromeframe">You are using an outdated browser. <a href="http://browsehappy.com/">Upgrade your browser today</a> or <a href="http://www.google.com/chromeframe/?redirect=true">install Google Chrome Frame</a> to better experience this site.</p>
        <![endif]-->

        <div class="header-container gw">
            <div class="g one-whole zen-space full-width"></div>
            <div class="wrapper">
                <header class="g one-whole flexbox" role="banner">
                    <h1 class="g one-third portable-one-whole flexbox__item"><a class="logo media" href="/" rel="nofollow"><img class="media__item" src="/assets/images/logo.jpg" alt="Rawrrr! Aniket here." /></a></h1>
                    <nav class="g two-thirds portable-one-whole flexbox__item navbar">
                        <ul class="nav nav--block portable-nav--stacked">
                            <li><a href="/">Home</a></li>
                            <li><a href="/about-me">About Me</a></li>
                            <li><a href="/Blog">Blog</a></li>
                            <li><a href="/archive">Archive</a></li>
                        </ul>
                    </nav>
                    <div class="g two-thirds portable-one-whole flexbox__item">
                        <p class="islet about-me">I'm <strong>Aniket</strong>. I love to code, listen to music and I even write free-verses at times. A majority of my work is <em>writing syntax for design</em>.</p>
                    </div>
                    <p rel="google-authorship" class="accessibility">By Aniket Pant</p>
                </header> <!-- header -->
            </div>
        </div> <!-- header-container -->

        <div class="main-container gw">
            <div class="wrapper">
                <section class="g one-whole" role="main">
                <div class="post send-emails-using-python">
	<header class="g one-quarter portable-one-whole post--header">
  		<h1 class="post_title">Send emails using Python</h1>
  		<div class="meta"><date class="date">Posted on 13 January 2012</date><br/>Under <span class="category">Blog</a><br/>Tagged </span><span class="tags">Python</span></div>
      <div class="share island">
        <a href="https://twitter.com/share" class="twitter-share-button" data-via="jayrambhia" data-related="jayrambhia">Tweet</a>
        <div class="g-plusone" data-size="medium"></div>
        <div class="fb-like" data-send="false" data-layout="button_count" data-width="450" data-show-faces="true"></div>
      </div>
      <div id="boastful"></div>
	</header><!-- post-header -->
	<div class="g three-quarters portable-one-whole">
		<article class="post--content">
	  	<h2 id="gmail-guihttpsgithubcomjayrambhiagmail-api-guiblobmastergmailgui2py"><a href="https://github.com/jayrambhia/Gmail-API-GUI/blob/master/gmailGUI2.py">Gmail GUI</a></h2>

<h2 id="gmail-apihttpsgithubcomjayrambhiabasic-gmail-apiblobmasterbasic-gmailpy"><a href="https://github.com/jayrambhia/Basic-Gmail-API/blob/master/Basic-gmail.py">Gmail API</a></h2>

<p>This is a program written in Python using which you can send an email with multiple attachments(any kind) to multiple recipients.
I have used libraries like smtplib, email, MIME, etc. The code proceeds by making an SMTP server. The libraries you might need to import.</p>

<pre><code>#!/usr/bin/python2.7
import smtplib
import email
import os
from email.MIMEMultipart import MIMEMultipart
from email.Utils import COMMASPACE
from email.MIMEBase import MIMEBase
from email.parser import Parser
from email.MIMEImage import MIMEImage
from email.MIMEText import MIMEText
from email.MIMEAudio import MIMEAudio
import mimetypes
</code></pre>

<p>Create an SMTP server. Connect it to the host.
Identify yourself to the server. » SMTP.ehlo()
Put the SMTP connection in TLS (Transport Layer Security) mode. All SMTP commands that follow will be encrypted.
Log in on the server.
more about smtplib : <a href="http://docs.python.org/library/smtplib.html">smtplib-docs</a></p>

<pre><code>server = smtplib.SMTP()
server.connect('host',port) # for eg. host = 'smtp.gmail.com', port = 587
server.ehlo()
server.starttls()
server.login('user', 'password')
</code></pre>

<!-- more -->

<p>SMTP server has been created and authorized for data transfer.
Create an email message with attachments. This part is here is a bit tricky and uses <strong>email</strong> library.
Get the required input from the user.</p>

<pre><code>fromaddr = raw_input('Send mail by the name of: ')
tolist = raw_input('To: ').split()
sub = raw_input('Subject: ')
</code></pre>

<p>Create the message <strong>msg</strong> which is an instance of email.mime.multipart.MIMEMultipart.
<strong>msg</strong> is like a dictionary object. It stores the content corresponding to keys.</p>

<pre><code>msg = email.MIMEMultipart.MIMEMultipart()
msg['From'] = fromaddr
msg['To'] = email.Utils.COMMASPACE.join(tolist)
msg['Subject'] = sub
msg.attach(MIMEText(raw_input('Body: ')))
msg.attach(MIMEText('nsent via python', 'plain')) # just a way to say.. Ha! I use Python.
</code></pre>

<p>For more information about MIMEBase visit <a href="http://docs.python.org/library/email.mime.html">email.mime</a>
So, now your email is ready but does not contain any attachments. To attach files, we need to use MIME library.
We open the file for reading in binary form. We find the content type and encoding type of the file using mimetypes.</p>

<pre><code>    filename = raw_input('File name: ')
    f = open(filename,'rb')
    ctype, encoding = mimetypes.guess_type(filename)

    if ctype is None or encoding is not None:
      ctype = 'application/octet-stream'
</code></pre>

<p>According to the type of the file, we use corresponding MIMEtype to encode the data of the file and save it in <strong>part</strong> which we would attach in <strong>msg</strong>. If subtype is other than ‘text’,’image’,’audio’, we encode the file with MIMEBase and attach the part as <strong>payload</strong> of <strong>msg</strong></p>

<pre><code>      maintype, subtype = ctype.split('/', 1)
      if maintype == 'text':
        part = MIMEText(f.read(), _subtype=subtype)
      elif maintype == 'image':
        part = MIMEImage(f.read(), _subtype=subtype)
      elif maintype == 'audio':
        part = MIMEAudio(f.read(), _subtype=subtype)
      else:
        part = MIMEBase(maintype, subtype)
        msg.set_payload(f.read())
      part.add_header('Content-Disposition', 'attachment; filename="%s"' % os.path.basename(filename))
      msg.attach(part)
      f.close()
</code></pre>

<p>email is ready. It just needs to be sent.</p>

<pre><code>server.sendmail(user,tolist,msg.as_string())
server.quit()
</code></pre>

<p>So this is a small example of how to send emails using smtplib, email, MIMEBase from Python!</p>

<h4 id="for-complete-code-including-receiving-emails--gmail-apihttpsgithubcomjayrambhiabasic-gmail-apiblobmasterbasic-gmailpy">For complete code (including receiving emails) : <a href="https://github.com/jayrambhia/Basic-Gmail-API/blob/master/Basic-gmail.py">Gmail API</a></h4>
<p>For Gmail application GUI : <a href="https://github.com/jayrambhia/Gmail-API-GUI/blob/master/gmailGUI2.py">Gmail GUI</a></p>

<p>P.S. It feels good to send emails via Python!</p>

<p>## </p>
  
		</article><!-- post-content -->
		<footer class="post--footer"></footer><!-- post-footer -->
    <section class="meta--info island">
      <p class="lead">
        <br/><br/>If you liked this post, then you should definitely follow Jay on twitter too. He would be excited to know that you like his work.
      </p>
      <a href="https://twitter.com/jayrambhia" class="twitter-follow-button" data-show-count="false">Follow @jayrambhia</a>
    </section>
  </div>
</div><!-- post -->

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.5.1/jquery.min.js"></script>
<script src="/assets/js/jquery.boastful.js"></script>
<script src="/assets/js/rainbow-custom.min.js"></script>

<script type="text/javascript">
  $(document).ready(function() {
    $('#boastful').boastful({
        empty_message: '<p>Bah! Why ain\'t anyone tweeting this.</p>'  
    });
  });
</script>
                </section>
            </div>
        </div> <!-- main-container -->

        <div class="footer-container gw">
            <div class="wrapper">
                <footer class="g one-whole text--center" role="contentinfo">
                    <a href="https://plus.google.com/114828599949215633124?rel=author" class="accessibility">Google +</a>
                    <p><a href="http://twitter.com/aniket_pant">@jayrambhia</a><span class="subtle">&nbsp;|&nbsp;Paranoid Android&nbsp;&nbsp;</span> 
                </footer> <!-- footer -->
            </div>
            <div class="g one-whole zen-space full-width"></div>
        </div> <!-- footer-container -->

        <script type="text/javascript">

          var _gaq = _gaq || [];
          _gaq.push(['_setAccount', 'UA-23477947-1']);
          _gaq.push(['_trackPageview']);

          (function() {
            var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
          })();

        </script>

        <!-- Typekit Fonts -->
        <script type="text/javascript">
          (function() {
            var config = {
              kitId: 'rsd5dqz',
              scriptTimeout: 3000
            };
            var h=document.getElementsByTagName("html")[0];h.className+=" wf-loading";var t=setTimeout(function(){h.className=h.className.replace(/(\s|^)wf-loading(\s|$)/g," ");h.className+=" wf-inactive"},config.scriptTimeout);var tk=document.createElement("script"),d=false;tk.src='//use.typekit.net/'+config.kitId+'.js';tk.type="text/javascript";tk.async="true";tk.onload=tk.onreadystatechange=function(){var a=this.readyState;if(d||a&&a!="complete"&&a!="loaded")return;d=true;clearTimeout(t);try{Typekit.load(config)}catch(b){}};var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(tk,s)
          })();

          (function(doc, script) {
            var js, 
                fjs = doc.getElementsByTagName(script)[0],
                frag = doc.createDocumentFragment(),
                add = function(url, id) {
                    if (doc.getElementById(id)) {return;}
                    js = doc.createElement(script);
                    js.src = url;
                    id && (js.id = id);
                    frag.appendChild( js );
                };
                
              // Google+ button
              add('http://apis.google.com/js/plusone.js');
              // Facebook SDK
              add('//connect.facebook.net/en_US/all.js#xfbml=1&appId=465363156848461', 'facebook-jssdk');
              // Twitter SDK
              add('//platform.twitter.com/widgets.js');

              fjs.parentNode.insertBefore(frag, fjs);
          }(document, 'script'));
        </script>

    </body>
</html>
