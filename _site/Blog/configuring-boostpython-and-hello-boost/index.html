<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
    <head >
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Configuring Boost::Python and Hello Boost &mdash; Aniket Pant</title>
        <meta name="author" content="">
        <meta name="description" content="">
        <meta name="keywords" content="jay, rambhia, computer vision, python, trakcing, keypoints, c, c++, simplecv, opencv">
        <meta name="viewport" content="width=device-width">

        
        

        <!-- stylesheets -->
        <link rel="stylesheet" href="/assets/styles/css/style.min.css">
    </head>
    <body>
        <!--[if lt IE 7]>
            <p class="chromeframe">You are using an outdated browser. <a href="http://browsehappy.com/">Upgrade your browser today</a> or <a href="http://www.google.com/chromeframe/?redirect=true">install Google Chrome Frame</a> to better experience this site.</p>
        <![endif]-->

        <div class="header-container gw">
            <div class="g one-whole zen-space full-width"></div>
            <div class="wrapper">
                <header class="g one-whole flexbox" role="banner">
                    <h1 class="g one-third portable-one-whole flexbox__item"><a class="logo media" href="/" rel="nofollow"><img class="media__item" src="/assets/images/logo.jpg" alt="Rawrrr! Aniket here." /></a></h1>
                    <nav class="g two-thirds portable-one-whole flexbox__item navbar">
                        <ul class="nav nav--block portable-nav--stacked">
                            <li><a href="/">Home</a></li>
                            <li><a href="/about-me">About Me</a></li>
                            <li><a href="/Blog">Blog</a></li>
                            <li><a href="/archive">Archive</a></li>
                        </ul>
                    </nav>
                    <div class="g two-thirds portable-one-whole flexbox__item">
                        <p class="islet about-me">I'm <strong>Aniket</strong>. I love to code, listen to music and I even write free-verses at times. A majority of my work is <em>writing syntax for design</em>.</p>
                    </div>
                    <p rel="google-authorship" class="accessibility">By Aniket Pant</p>
                </header> <!-- header -->
            </div>
        </div> <!-- header-container -->

        <div class="main-container gw">
            <div class="wrapper">
                <section class="g one-whole" role="main">
                <div class="post configuring-boostpython-and-hello-boost">
	<header class="g one-quarter portable-one-whole post--header">
  		<h1 class="post_title">Configuring Boost::Python and Hello Boost</h1>
  		<div class="meta"><date class="date">Posted on 25 June 2012</date><br/>Under <span class="category">Blog</a><br/>Tagged </span><span class="tags">Computer Vision</span></div>
      <div class="share island">
        <a href="https://twitter.com/share" class="twitter-share-button" data-via="jayrambhia" data-related="jayrambhia">Tweet</a>
        <div class="g-plusone" data-size="medium"></div>
        <div class="fb-like" data-send="false" data-layout="button_count" data-width="450" data-show-faces="true"></div>
      </div>
      <div id="boastful"></div>
	</header><!-- post-header -->
	<div class="g three-quarters portable-one-whole">
		<article class="post--content">
	  	<p>In my recent blog posts, I have mentioned that python is quite slow and I need to find an option to increase run-time speed of my python port of OpenTLD. I need to extend Python with C++ and hence I was looking at all the available options. I have once used <strong>swig bindings</strong>. I can’t say anything about it’s performance, but it was kind of boring to use swig. I had to make few files and then compile and make. So I started looking at other options. <strong>Python/C API</strong> is good but you need to pass pointer reference, objects and sometimes it just becomes messy. I have never tried <strong>Cython</strong>. I might give it a shot. </p>

<p>Moving on to <strong>Boost::Python</strong>. Python already provides an API for gluing together Python and C. Boost::Python is a wrapper for Python/C API. Using the Python/C API, you have to deal with passing pointers back and forth between Python and C, and worry about pointers hanging out in one place when the object they point to has been thrown away.
Boost:Python takes care of all of that and lets you write operations on Python objects in C++ in OOP style.</p>

<p>For example, using the Python/C API, to do the C++ equivalent of “y = object_x[i]”, you might do:</p>

<p><code>y = PySequence_GetItem(object_x, i);</code></p>

<p>By contrast, in Boost::Python, you can just do:</p>

<p><code>y = object_x[i];</code></p>

<p>Boost:Python makes it very easy to export C++ classes into Python. Boost::Python is designed in such a way that users never need to use <strong>PyObject</strong>*</p>

<h4 id="configure-boostpython-on-ubuntu-1204"><strong>Configure Boost::Python on Ubuntu 12.04</strong>:</h4>

<p>This is the official page of Boost about configuring Boost::Python http://www.boost.org/doc/libs/1<em>41</em>0/libs/python/doc/building.html . I tried to follow that, but couldn’t understand much. I visited pages of pyopencv and pyopencl on code.google.com, where I found a very easy way to install and configure Boost::Python.</p>

<blockquote>
  <p><strong>sudo apt-get install libboost1.48-all-dev</strong></p>
</blockquote>

<p>That’s it. Boost::Python is install and automatically configured. It also require some bjam library, but it turns out that either it’s available in libboost1.48-dev or it has been obsoleted. No problems there.</p>

<h4 id="hello-boost"><strong>Hello Boost</strong>:</h4>

<p>I have found this link very helpful in making hello world program using Boost::Python. http://www.shocksolution.com/python-basics-tutorials-and-examples/linking-python-and-c-with-boostpython/</p>

<p>Writing a <strong>Hello World</strong> program using Boost::Python.</p>

<p>Create a file named <strong>hello_ext.c</strong></p>

<pre><code>char const* greet()
{
    return "hello, world";
}

#include&lt;boost/python.hpp&gt;

BOOST_PYTHON_MODULE(hello_ext)
{
    using namespace boost::python;
    def("greet",greet);
}
</code></pre>

<p>After making the C++ file, we need to make .so file. For that we need to make it.
Create a <strong>Makefile</strong></p>

<pre><code>PYTHON_VERSION = 2.7
PYTHON_INCLUDE = /usr/include/python$(PYTHON_VERSION)

# location of the Boost Python include files and library

BOOST_INC = /usr/include
BOOST_LIB = /usr/lib

# compile mesh classes
TARGET = hello_ext

$(TARGET).so: $(TARGET).o
	g++ -shared -Wl,--export-dynamic $(TARGET).o -L$(BOOST_LIB) -lboost_python -L/usr/lib/python$(PYTHON_VERSION)/config -lpython$(PYTHON_VERSION) -o $(TARGET).so

$(TARGET).o: $(TARGET).c
	g++ -I$(PYTHON_INCLUDE) -I$(BOOST_INC) -fPIC -c $(TARGET).c
</code></pre>

<p><strong>Makefile</strong> is ready. Now, make it and import hello_ext in python.</p>

<blockquote>
  <p><strong>make</strong></p>
</blockquote>

<pre><code>import hello_ext
print hello_ext.greet()
</code></pre>

<p><strong>This python file has to be in the same directory as that of hello_ext.so</strong>.
Or, you can copy hello_ext.so to /usr/local/lib/python2.7/dist-packages/</p>

<blockquote>
  <p><strong>sudo cp hello_ext.so /usr/local/lib/python2.7/dist-packages/</strong></p>
</blockquote>

<p>Now, since you have added <strong>hello_ext.so</strong>to PYTHON_PATH, you can <strong>import hello_ext</strong>.</p>

<p>So, Hello Boost done. I’ll move on to classes and other stuff. Final goal: Using Boost::Python to port OpenTLD to python.</p>

<p>P.S. I’ll be getting SimpleCV t-shirt and stickers in few days. yay.</p>
  
		</article><!-- post-content -->
		<footer class="post--footer"></footer><!-- post-footer -->
    <section class="meta--info island">
      <p class="lead">
        <br/><br/>If you liked this post, then you should definitely follow Jay on twitter too. He would be excited to know that you like his work.
      </p>
      <a href="https://twitter.com/jayrambhia" class="twitter-follow-button" data-show-count="false">Follow @jayrambhia</a>
    </section>
  </div>
</div><!-- post -->

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.5.1/jquery.min.js"></script>
<script src="/assets/js/jquery.boastful.js"></script>
<script src="/assets/js/rainbow-custom.min.js"></script>

<script type="text/javascript">
  $(document).ready(function() {
    $('#boastful').boastful({
        empty_message: '<p>Bah! Why ain\'t anyone tweeting this.</p>'  
    });
  });
</script>
                </section>
            </div>
        </div> <!-- main-container -->

        <div class="footer-container gw">
            <div class="wrapper">
                <footer class="g one-whole text--center" role="contentinfo">
                    <a href="https://plus.google.com/114828599949215633124?rel=author" class="accessibility">Google +</a>
                    <p><a href="http://twitter.com/aniket_pant">@jayrambhia</a><span class="subtle">&nbsp;|&nbsp;Paranoid Android&nbsp;&nbsp;</span> 
                </footer> <!-- footer -->
            </div>
            <div class="g one-whole zen-space full-width"></div>
        </div> <!-- footer-container -->

        <script type="text/javascript">

          var _gaq = _gaq || [];
          _gaq.push(['_setAccount', 'UA-23477947-1']);
          _gaq.push(['_trackPageview']);

          (function() {
            var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
          })();

        </script>

        <!-- Typekit Fonts -->
        <script type="text/javascript">
          (function() {
            var config = {
              kitId: 'rsd5dqz',
              scriptTimeout: 3000
            };
            var h=document.getElementsByTagName("html")[0];h.className+=" wf-loading";var t=setTimeout(function(){h.className=h.className.replace(/(\s|^)wf-loading(\s|$)/g," ");h.className+=" wf-inactive"},config.scriptTimeout);var tk=document.createElement("script"),d=false;tk.src='//use.typekit.net/'+config.kitId+'.js';tk.type="text/javascript";tk.async="true";tk.onload=tk.onreadystatechange=function(){var a=this.readyState;if(d||a&&a!="complete"&&a!="loaded")return;d=true;clearTimeout(t);try{Typekit.load(config)}catch(b){}};var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(tk,s)
          })();

          (function(doc, script) {
            var js, 
                fjs = doc.getElementsByTagName(script)[0],
                frag = doc.createDocumentFragment(),
                add = function(url, id) {
                    if (doc.getElementById(id)) {return;}
                    js = doc.createElement(script);
                    js.src = url;
                    id && (js.id = id);
                    frag.appendChild( js );
                };
                
              // Google+ button
              add('http://apis.google.com/js/plusone.js');
              // Facebook SDK
              add('//connect.facebook.net/en_US/all.js#xfbml=1&appId=465363156848461', 'facebook-jssdk');
              // Twitter SDK
              add('//platform.twitter.com/widgets.js');

              fjs.parentNode.insertBefore(frag, fjs);
          }(document, 'script'));
        </script>

    </body>
</html>
