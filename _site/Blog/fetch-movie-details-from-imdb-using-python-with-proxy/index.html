<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
    <head >
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Fetch Movie Details from IMDB using Python (with Proxy) &mdash; Aniket Pant</title>
        <meta name="author" content="">
        <meta name="description" content="">
        <meta name="keywords" content="jay, rambhia, computer vision, python, trakcing, keypoints, c, c++, simplecv, opencv">
        <meta name="viewport" content="width=device-width">

        
        

        <!-- stylesheets -->
        <link rel="stylesheet" href="/assets/styles/css/style.min.css">
    </head>
    <body>
        <!--[if lt IE 7]>
            <p class="chromeframe">You are using an outdated browser. <a href="http://browsehappy.com/">Upgrade your browser today</a> or <a href="http://www.google.com/chromeframe/?redirect=true">install Google Chrome Frame</a> to better experience this site.</p>
        <![endif]-->

        <div class="header-container gw">
            <div class="g one-whole zen-space full-width"></div>
            <div class="wrapper">
                <header class="g one-whole flexbox" role="banner">
                    <h1 class="g one-third portable-one-whole flexbox__item"><a class="logo media" href="/" rel="nofollow"><img class="media__item" src="/assets/images/logo.jpg" alt="Rawrrr! Aniket here." /></a></h1>
                    <nav class="g two-thirds portable-one-whole flexbox__item navbar">
                        <ul class="nav nav--block portable-nav--stacked">
                            <li><a href="/">Home</a></li>
                            <li><a href="/about-me">About Me</a></li>
                            <li><a href="/Blog">Blog</a></li>
                            <li><a href="/archive">Archive</a></li>
                        </ul>
                    </nav>
                    <div class="g two-thirds portable-one-whole flexbox__item">
                        <p class="islet about-me">I'm <strong>Aniket</strong>. I love to code, listen to music and I even write free-verses at times. A majority of my work is <em>writing syntax for design</em>.</p>
                    </div>
                    <p rel="google-authorship" class="accessibility">By Aniket Pant</p>
                </header> <!-- header -->
            </div>
        </div> <!-- header-container -->

        <div class="main-container gw">
            <div class="wrapper">
                <section class="g one-whole" role="main">
                <div class="post fetch-movie-details-from-imdb-using-python-with-proxy">
	<header class="g one-quarter portable-one-whole post--header">
  		<h1 class="post_title">Fetch Movie Details from IMDB using Python (with Proxy)</h1>
  		<div class="meta"><date class="date">Posted on 26 January 2012</date><br/>Under <span class="category">Blog</a><br/>Tagged </span><span class="tags">Python</span></div>
      <div class="share island">
        <a href="https://twitter.com/share" class="twitter-share-button" data-via="jayrambhia" data-related="jayrambhia">Tweet</a>
        <div class="g-plusone" data-size="medium"></div>
        <div class="fb-like" data-send="false" data-layout="button_count" data-width="450" data-show-faces="true"></div>
      </div>
      <div id="boastful"></div>
	</header><!-- post-header -->
	<div class="g three-quarters portable-one-whole">
		<article class="post--content">
	  	<p><strong>Tags</strong>: <strong>Python</strong>, <strong>IMDB</strong>, <strong>BeautifulSoup</strong>, <strong>Proxy</strong>, <strong>Browser</strong>, <strong>Mechanize</strong>, <strong>Movie</strong>, <strong>Parsing</strong></p>

<h3 id="imdb-py-gisthttpsgistgithubcom1678382"><a href="https://gist.github.com/1678382">IMDB-py Gist</a></h3>

<update>**I have added a new and a bit better python script to fetch movie details from IMDB has been updated on my gits. visit imdb gist or go to the bottom of the post.** <update>

Lately I have started working on Social Data Mining and probably Machine Learning (will start shortly).
So, for social data mining I am taking data from Twitter. To know how **BeautifulSoup** works, I was told to make something up which would parse html/xml (well, That's what BeautifulSoup does!). An app was in my mind which would take the name of the movie and search it on the IMDB and provide all the details about it.
I always thought that the sites like IMDB would be having some kind of script (javascript/php)! and as I don't know either of them, I gave up the idea. But then one day, [Abhinav Gupta](https://twitter.com/TheMarwariJew) told me about the IMDB website, and when I looked the source code up, I was shocked! No backend script! Pure HTML! and then there was BeautifulSoup!

So it's really easy to get all the required information once you get to the movie page. BeautifulSoup will do the rest for you!
**Importing modules**

    
    from BeautifulSoup import BeautifulSoup
    from mechanize import Browser
    import re




<!-- more -->



First, search the movie on IMDB! The movie is The Dark Knight
The IMDB search URL looks like this "http://www.imdb.com/find?q=The+Dark+Knight&amp;s=all"

**Creating the URL of the search page!**

    
    movie = raw_input()
    movie_search = '+'.join(movie.split())
    base_url = 'http://www.imdb.com/find?q='
    url = base_url+movie_search+'&amp;s=all'




I had made this app purely with urllib2. But then Abhinav told me to make it using mechanize.Browser as it's faster.
So, I have used mechanize.Browser.
Now, I'm in BITS, Pilani - Goa! And one thing you can be sure of is that there would be proxies everywhere blocking every script! and now they have started authentication with LDAP server!

**Setting up the Proxy**

    
    br = Browser()
    br.set_proxies({'http':'http://username:password@proxy:port',
                   'https':'https://username:password@proxy:port'})




Proxy settings done! Now, open url and parse html!

Every movie on IMDB is given a particular id! and the movie page URL is "http://www.imdb.com/tt/id"
So we search the id of the corresponding movie on the search page and move to the movie page.
**Finding the title id and the title page link**

    
    br.open(url)
    link = br.find_link(url_regex = re.compile(r'/title/tt.*'))
    res = br.follow_link(link)




The movie webpage has been accessed. Now move aside and let **BeautifulSoup** do the work!
**Parsing with **BeautifulSoup****

    
    soup = BeautifulSoup(res.read())
    
    movie_title = soup.find('title').contents[0]
    rate = soup.find('span',itemprop='ratingValue')
    rating = str(rate.contents[0])
    
    actors=[]
    actors_soup = soup.findAll('a',itemprop='actors')
    for i in range(len(actors_soup)):
      actors.append(actors_soup[i].contents[0])
    
    des = str(soup.findAll('meta')[3])
    des = des.split('content')[1].split('"')[1]
    
    genre=[]
    for div in soup.findAll('div'):
      if div.has_key('class') and div['class'] == 'infobar':
        for con in div.contents:
          try:
            if con.has_key('title'):
              r = con['title']
            elif con.has_key('href'):
              genre.append(con['href'])
    
          except AttributeError:
            pass
    
    for i in range(len(genre)):
      genre[i] = genre[i].split('/')[-1]




Ok. This will give you all the information that you require! Now just print everything!
And now access IMDB with Python!
Cheers!
P.S. O! BeautifulSoup thou art beautiful!

<update>
New script:

    
    '''
    Author : Jay Rambhia
    email : jayrambhia777@gmail.com
    Git : https://github.com/jayrambhia
    gist : https://gist.github.com/jayrambhia
    '''
    
    import urllib2
    from BeautifulSoup import BeautifulSoup
    from mechanize import Browser
    import re
    
    def getunicode(soup):
      body=''
      if isinstance(soup, unicode):
        soup = soup.replace(''',"'")
        soup = soup.replace('&quot;','"')
        soup = soup.replace('&nbsp;',' ')
        body = body + soup
      else:
        if not soup.contents:
        return ''
        con_list = soup.contents
        for con in con_list:
          body = body + getunicode(con)
      return body
    
    def main():
      movie = str(raw_input('Movie Name: '))
      movie_search = '+'.join(movie.split())
    
      base_url = 'http://www.imdb.com/find?q='
      url = base_url+movie_search+'&amp;s=all'
    
      title_search = re.compile('/title/ttd+')
    
      br = Browser()
      br.set_proxies({'http':'http://username:password@proxy:port',
                        'https':'https://username:password@proxy:port'})
    
      br.open(url)
    
      link = br.find_link(url_regex = re.compile(r'/title/tt.*'))
      res = br.follow_link(link)
    
      soup = BeautifulSoup(res.read())
    
      movie_title = getunicode(soup.find('title'))
      rate = soup.find('span',itemprop='ratingValue')
      rating = getunicode(rate)
    
      actors=[]
      actors_soup = soup.findAll('a',itemprop='actors')
      for i in range(len(actors_soup)):
        actors.append(getunicode(actors_soup[i]))
    
      des = soup.find('meta',{'name':'description'})['content']
    
      genre=[]
      infobar = soup.find('div',{'class':'infobar'})
      r = infobar.find('',{'title':True})['title']
      genrelist = infobar.findAll('a',{'href':True})
    
      for i in range(len(genrelist)-1):
        genre.append(getunicode(genrelist[i]))
      release_date = getunicode(genrelist[-1])
    
      print movie_title,rating+'/10.0'
      print 'Relase Date:',release_date
      print 'Rated',r
      print ''
      print 'Genre:',
      print ', '.join(genre)
      print 'nActors:',
      print ', '.join(actors)
      print 'nDescription:'
      print des
    
    if __name__ == '__main__':
        main()
    



</update></update></update>
  
		</article><!-- post-content -->
		<footer class="post--footer"></footer><!-- post-footer -->
    <section class="meta--info island">
      <p class="lead">
        <br/><br/>If you liked this post, then you should definitely follow Jay on twitter too. He would be excited to know that you like his work.
      </p>
      <a href="https://twitter.com/jayrambhia" class="twitter-follow-button" data-show-count="false">Follow @jayrambhia</a>
    </section>
  </div>
</div><!-- post -->

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.5.1/jquery.min.js"></script>
<script src="/assets/js/jquery.boastful.js"></script>
<script src="/assets/js/rainbow-custom.min.js"></script>

<script type="text/javascript">
  $(document).ready(function() {
    $('#boastful').boastful({
        empty_message: '<p>Bah! Why ain\'t anyone tweeting this.</p>'  
    });
  });
</script>
                </section>
            </div>
        </div> <!-- main-container -->

        <div class="footer-container gw">
            <div class="wrapper">
                <footer class="g one-whole text--center" role="contentinfo">
                    <a href="https://plus.google.com/114828599949215633124?rel=author" class="accessibility">Google +</a>
                    <p><a href="http://twitter.com/aniket_pant">@jayrambhia</a><span class="subtle">&nbsp;|&nbsp;Paranoid Android&nbsp;&nbsp;</span> 
                </footer> <!-- footer -->
            </div>
            <div class="g one-whole zen-space full-width"></div>
        </div> <!-- footer-container -->

        <script type="text/javascript">

          var _gaq = _gaq || [];
          _gaq.push(['_setAccount', 'UA-23477947-1']);
          _gaq.push(['_trackPageview']);

          (function() {
            var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
          })();

        </script>

        <!-- Typekit Fonts -->
        <script type="text/javascript">
          (function() {
            var config = {
              kitId: 'rsd5dqz',
              scriptTimeout: 3000
            };
            var h=document.getElementsByTagName("html")[0];h.className+=" wf-loading";var t=setTimeout(function(){h.className=h.className.replace(/(\s|^)wf-loading(\s|$)/g," ");h.className+=" wf-inactive"},config.scriptTimeout);var tk=document.createElement("script"),d=false;tk.src='//use.typekit.net/'+config.kitId+'.js';tk.type="text/javascript";tk.async="true";tk.onload=tk.onreadystatechange=function(){var a=this.readyState;if(d||a&&a!="complete"&&a!="loaded")return;d=true;clearTimeout(t);try{Typekit.load(config)}catch(b){}};var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(tk,s)
          })();

          (function(doc, script) {
            var js, 
                fjs = doc.getElementsByTagName(script)[0],
                frag = doc.createDocumentFragment(),
                add = function(url, id) {
                    if (doc.getElementById(id)) {return;}
                    js = doc.createElement(script);
                    js.src = url;
                    id && (js.id = id);
                    frag.appendChild( js );
                };
                
              // Google+ button
              add('http://apis.google.com/js/plusone.js');
              // Facebook SDK
              add('//connect.facebook.net/en_US/all.js#xfbml=1&appId=465363156848461', 'facebook-jssdk');
              // Twitter SDK
              add('//platform.twitter.com/widgets.js');

              fjs.parentNode.insertBefore(frag, fjs);
          }(document, 'script'));
        </script>

    </body>
</html>
