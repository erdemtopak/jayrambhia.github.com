<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
    <head >
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Tracking in OpenTLD aka Predator &mdash; Aniket Pant</title>
        <meta name="author" content="">
        <meta name="description" content="">
        <meta name="keywords" content="jay, rambhia, computer vision, python, trakcing, keypoints, c, c++, simplecv, opencv">
        <meta name="viewport" content="width=device-width">

        
        

        <!-- stylesheets -->
        <link rel="stylesheet" href="/assets/styles/css/style.min.css">
    </head>
    <body>
        <!--[if lt IE 7]>
            <p class="chromeframe">You are using an outdated browser. <a href="http://browsehappy.com/">Upgrade your browser today</a> or <a href="http://www.google.com/chromeframe/?redirect=true">install Google Chrome Frame</a> to better experience this site.</p>
        <![endif]-->

        <div class="header-container gw">
            <div class="g one-whole zen-space full-width"></div>
            <div class="wrapper">
                <header class="g one-whole flexbox" role="banner">
                    <h1 class="g one-third portable-one-whole flexbox__item"><a class="logo media" href="/" rel="nofollow"><img class="media__item" src="/assets/images/logo.jpg" alt="Rawrrr! Aniket here." /></a></h1>
                    <nav class="g two-thirds portable-one-whole flexbox__item navbar">
                        <ul class="nav nav--block portable-nav--stacked">
                            <li><a href="/">Home</a></li>
                            <li><a href="/about-me">About Me</a></li>
                            <li><a href="/Blog">Blog</a></li>
                            <li><a href="/archive">Archive</a></li>
                        </ul>
                    </nav>
                    <div class="g two-thirds portable-one-whole flexbox__item">
                        <p class="islet about-me">I'm <strong>Aniket</strong>. I love to code, listen to music and I even write free-verses at times. A majority of my work is <em>writing syntax for design</em>.</p>
                    </div>
                    <p rel="google-authorship" class="accessibility">By Aniket Pant</p>
                </header> <!-- header -->
            </div>
        </div> <!-- header-container -->

        <div class="main-container gw">
            <div class="wrapper">
                <section class="g one-whole" role="main">
                <div class="post tracking-in-opentld-aka-predator">
	<header class="g one-quarter portable-one-whole post--header">
  		<h1 class="post_title">Tracking in OpenTLD aka Predator</h1>
  		<div class="meta"><date class="date">Posted on 05 June 2012</date><br/>Under <span class="category">Blog</a><br/>Tagged </span><span class="tags">Computer Vision</span></div>
      <div class="share island">
        <a href="https://twitter.com/share" class="twitter-share-button" data-via="jayrambhia" data-related="jayrambhia">Tweet</a>
        <div class="g-plusone" data-size="medium"></div>
        <div class="fb-like" data-send="false" data-layout="button_count" data-width="450" data-show-faces="true"></div>
      </div>
      <div id="boastful"></div>
	</header><!-- post-header -->
	<div class="g three-quarters portable-one-whole">
		<article class="post--content">
	  	<p>As my Google Summer of Code 2012 project, I have to port OpenTLD to python using OpenCV and SimpleCV. OpenTLD a.k.a. Predator was first made by <strong><a href="http://info.ee.surrey.ac.uk/Personal/Z.Kalal/"> Zdenek Kalal </a></strong> in MATLAB. <strong><a href="https://github.com/zk00006/OpenTLD/">OpenTLD</a></strong>. It is one of the most reliable algorithms to track objects. The algorithm include <strong>on-line</strong> training and learning.
The algorithm which consists of <strong>off-line</strong> training take days and lots of data to train and learn.</p>

<p>Here’s my brief understanding of how OpenTLD algorithm works.</p>

<p>As the name suggests, it consists of three main parts.</p>

<ul>
  <li>
    <p><strong>Tracking</strong></p>
  </li>
  <li>
    <p><strong>Learning</strong></p>
  </li>
  <li>
    <p><strong>Detection</strong></p>
  </li>
</ul>

<p><a href="http://www.jayrambhia.com/blog/wp-content/uploads/2012/06/tld-algo.jpg"><img src="http://www.jayrambhia.com/blog/wp-content/uploads/2012/06/tld-algo.jpg" alt="OpenTLD" /></a></p>

<h6 id="tracking"><strong>Tracking</strong>:</h6>

<p>Adaptive Tracking is used in OpenTLD. A Median Flow Tracker is made using Lucas-Kanede Tracker with pyramids and with the help of Forward-Backward error, and focusing on 50% of the most reliable points.
As Zdenek Kalal quoted in his GoogleTech Talk about Predator</p>

<p>”<strong>Every tracker eventually fails and requires a detector</strong>.”</p>

<p>###### </p>

<h6 id="detection"><strong>Detection</strong>:</h6>

<p>Classifiers are continuously trained from each and every frame. For every frame, Classifiers are evaluated. Errors are estimated via feedback. According to the feedback, classifiers are updated to detect more efficiently.
Ensemble classifier and 1NN classifier are used in detection.</p>

<h6 id="feedback-in-opentldhttpwwwjayrambhiacomblogwp-contentuploads201206feedbackjpghttpwwwjayrambhiacomblogwp-contentuploads201206feedbackjpg"><a href="http://www.jayrambhia.com/blog/wp-content/uploads/2012/06/feedback.jpg"><img src="http://www.jayrambhia.com/blog/wp-content/uploads/2012/06/feedback.jpg" alt="feedback in openTLD" /></a></h6>

<h6 id="learning"><strong>Learning</strong>:</h6>

<p>The tracker learns using P-N learning (Positive-Negative) which learns an object classifier and labels all the patches as “object”(positive) and “background”(negative).It uses a tracker for providing positive and detector for negative training examples.</p>

<p><a href="http://www.jayrambhia.com/blog/wp-content/uploads/2012/06/pn.jpg"><img src="http://www.jayrambhia.com/blog/wp-content/uploads/2012/06/pn.jpg" alt="PN Learning - OpenTLD" /></a></p>

<p>###### </p>

<p>I have started working on OpenTLD for couple of weeks now. I have made a Median Flow tracker for “Tracking” part of OpenTLD. Here’s how the “Tracking” part works in OpenTLD.</p>

<p>###### </p>

<p>This is how Median Flow Tracker works:</p>

<p>**
  * Initialize points to a grid
**
<strong><a href="https://github.com/jayrambhia/MFTracker/blob/master/mftracker/bb.py#L21"> Get Filled points in the Bounding Box </a></strong></p>

<p>**
  * Track points between frame
**
Points are tracked using <strong><a href="https://github.com/jayrambhia/MFTracker/blob/master/mftracker/lk.py">Lucas-Kanede Tracker</a></strong> with pyramids.
**
  * Estimate reliability of the points
**
To get reliable points, Forward-Backward error method is used. In FB method, points are tracked twice.
tracked points for <strong>current image -&gt; previous image</strong>
tracked points for <strong>previous image -&gt; current image</strong>
So, intersection of both of point sets would give me reliable tracked points.
<strong><a href="https://github.com/jayrambhia/MFTracker/blob/master/mftracker/fbtrack.py">Forward-Backward Error</a></strong></p>

<p>**
  * Filter out 50% of the outliers
**
50% of the points are filtered out using median filter. First the median is calculated for the vector of points, and most reliable points are chosen. </p>

<p>**
  * Estimate the new bounding box
**
New bounding box is estimated based on all relative distance changes of all points to every point. The median of the relative value is used for calculation. **<a href="https://github.com/jayrambhia/MFTracker/blob/master/mftracker/bb.py#L123">Predict Bounding Box**</a></p>

<h6 id="mf-tracker-githubhttpsgithubcomjayrambhiamftracker"><strong><a href="https://github.com/jayrambhia/MFTracker">MF Tracker GitHub</a></strong></h6>

<p>[youtube=http://www.youtube.com/watch?v=z55Ew2vCV8o]</p>

<p>P.S. Now working on <strong>Learning</strong> part.</p>

  
		</article><!-- post-content -->
		<footer class="post--footer"></footer><!-- post-footer -->
    <section class="meta--info island">
      <p class="lead">
        <br/><br/>If you liked this post, then you should definitely follow Jay on twitter too. He would be excited to know that you like his work.
      </p>
      <a href="https://twitter.com/jayrambhia" class="twitter-follow-button" data-show-count="false">Follow @jayrambhia</a>
    </section>
  </div>
</div><!-- post -->

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.5.1/jquery.min.js"></script>
<script src="/assets/js/jquery.boastful.js"></script>
<script src="/assets/js/rainbow-custom.min.js"></script>

<script type="text/javascript">
  $(document).ready(function() {
    $('#boastful').boastful({
        empty_message: '<p>Bah! Why ain\'t anyone tweeting this.</p>'  
    });
  });
</script>
                </section>
            </div>
        </div> <!-- main-container -->

        <div class="footer-container gw">
            <div class="wrapper">
                <footer class="g one-whole text--center" role="contentinfo">
                    <a href="https://plus.google.com/114828599949215633124?rel=author" class="accessibility">Google +</a>
                    <p><a href="http://twitter.com/aniket_pant">@jayrambhia</a><span class="subtle">&nbsp;|&nbsp;Paranoid Android&nbsp;&nbsp;</span> 
                </footer> <!-- footer -->
            </div>
            <div class="g one-whole zen-space full-width"></div>
        </div> <!-- footer-container -->

        <script type="text/javascript">

          var _gaq = _gaq || [];
          _gaq.push(['_setAccount', 'UA-23477947-1']);
          _gaq.push(['_trackPageview']);

          (function() {
            var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
          })();

        </script>

        <!-- Typekit Fonts -->
        <script type="text/javascript">
          (function() {
            var config = {
              kitId: 'rsd5dqz',
              scriptTimeout: 3000
            };
            var h=document.getElementsByTagName("html")[0];h.className+=" wf-loading";var t=setTimeout(function(){h.className=h.className.replace(/(\s|^)wf-loading(\s|$)/g," ");h.className+=" wf-inactive"},config.scriptTimeout);var tk=document.createElement("script"),d=false;tk.src='//use.typekit.net/'+config.kitId+'.js';tk.type="text/javascript";tk.async="true";tk.onload=tk.onreadystatechange=function(){var a=this.readyState;if(d||a&&a!="complete"&&a!="loaded")return;d=true;clearTimeout(t);try{Typekit.load(config)}catch(b){}};var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(tk,s)
          })();

          (function(doc, script) {
            var js, 
                fjs = doc.getElementsByTagName(script)[0],
                frag = doc.createDocumentFragment(),
                add = function(url, id) {
                    if (doc.getElementById(id)) {return;}
                    js = doc.createElement(script);
                    js.src = url;
                    id && (js.id = id);
                    frag.appendChild( js );
                };
                
              // Google+ button
              add('http://apis.google.com/js/plusone.js');
              // Facebook SDK
              add('//connect.facebook.net/en_US/all.js#xfbml=1&appId=465363156848461', 'facebook-jssdk');
              // Twitter SDK
              add('//platform.twitter.com/widgets.js');

              fjs.parentNode.insertBefore(frag, fjs);
          }(document, 'script'));
        </script>

    </body>
</html>
